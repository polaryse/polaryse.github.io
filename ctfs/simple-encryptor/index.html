

<!DOCTYPE html>
<html lang="en-us" dir="ltr" class="scroll-smooth" data-default-appearance="dark"
  data-auto-appearance="true"><head>
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="en-us" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>HTB Challenge: Simple Encryptor Part 1 &middot; Malware Analysis: Or How I Learned To Love Frustration</title>
  <meta name="title" content="HTB Challenge: Simple Encryptor Part 1 &middot; Malware Analysis: Or How I Learned To Love Frustration" />
  
  
  
  
  
  <link rel="canonical" href="https://polaryse.github.io/ctfs/simple-encryptor/" />
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="/css/main.bundle.min.46f9ffa24eae27e9c12d7fb4acd993c38d401b80b028e4d0a8f6bac03b6c933a6bed190cfecbd9df1a1454c6ed16ac4570e5683debe8519f64f170d4728fbfc0.css"
    integrity="sha512-Rvn/ok6uJ&#43;nBLX&#43;0rNmTw41AG4CwKOTQqPa6wDtskzpr7RkM/svZ3xoUVMbtFqxFcOVoPevoUZ9k8XDUco&#43;/wA==" />
  
  
  <script type="text/javascript" src="/js/main.min.cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e.js" integrity="sha512-z4PhNX7vuL3xVChQ1m2AB9Yg5AULVxXcg/SpIdNs6c5H0NE8XYXysP&#43;DGNKHfuwvY7kxvUdBeoGlODJ6&#43;SfaPg=="></script>
  
  
  <script type="text/javascript" src="/js/appearance.min.f94f4c4636d9e3ec8f5ee53cdc8ffa3d01bf87cd92ac85e6797550b1e2b80dc9118d838f3eb24c55109352455e72ff082dfe560283154e5a8f87fd75107b59c4.js"
    integrity="sha512-&#43;U9MRjbZ4&#43;yPXuU83I/6PQG/h82SrIXmeXVQseK4DckRjYOPPrJMVRCTUkVecv8ILf5WAoMVTlqPh/11EHtZxA=="></script>
  
  
  
  
  
  
  
  
  
  
  
  
  <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.3ddcf04f5b0d4c32f72e726d3c12eebccd8c3c9f9daa9a13414808895de0ae1e1cdddda6849680d5bd96dbb60d0b1e0b24c29f5c83e5631e55e7e6bc02015490.js"
    integrity="sha512-PdzwT1sNTDL3LnJtPBLuvM2MPJ&#43;dqpoTQUgIiV3grh4c3d2mhJaA1b2W27YNCx4LJMKfXIPlYx5V5&#43;a8AgFUkA==" data-copy="" data-copied=""></script>
  
  <script src="/js/zoom.min.js"></script>
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  <meta property="og:title" content="HTB Challenge: Simple Encryptor Part 1" />
<meta property="og:description" content="Pulling apart a custom simple encryptor from a Hack the Box RE challenge using Ghidra. Part 1 of 2 explores the static analysis process." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://polaryse.github.io/ctfs/simple-encryptor/" /><meta property="og:image" content="https://polaryse.github.io/ctfs/simple-encryptor/featured.jpeg"/><meta property="article:section" content="CTFs" />
<meta property="article:published_time" content="2023-03-18T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-03-18T00:00:00+00:00" /><meta property="og:site_name" content="Malware Analysis: Or How I Learned To Love Frustration" />

  <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://polaryse.github.io/ctfs/simple-encryptor/featured.jpeg"/>
<meta name="twitter:title" content="HTB Challenge: Simple Encryptor Part 1"/>
<meta name="twitter:description" content="Pulling apart a custom simple encryptor from a Hack the Box RE challenge using Ghidra. Part 1 of 2 explores the static analysis process."/>

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "CTFs",
    "name": "HTB Challenge: Simple Encryptor Part 1",
    "headline": "HTB Challenge: Simple Encryptor Part 1",
    
    "abstract": "Pulling apart a custom simple encryptor from a Hack the Box RE challenge using Ghidra. Part 1 of 2 explores the static analysis process.",
    "inLanguage": "en-us",
    "url" : "https:\/\/polaryse.github.io\/ctfs\/simple-encryptor\/",
    "author" : {
      "@type": "Person",
      "name": "polaryse"
    },
    "copyrightYear": "2023",
    "dateCreated": "2023-03-18T00:00:00\u002b00:00",
    "datePublished": "2023-03-18T00:00:00\u002b00:00",
    
    "dateModified": "2023-03-18T00:00:00\u002b00:00",
    
    "keywords": ["Ghidra","Reverse Engineering","Cyptographic Algorithms"],
    
    "mainEntityOfPage": "true",
    "wordCount": "2990"
  }]
  </script>


  
  
  <meta name="author" content="polaryse" />
  
  
  
  <link href="https://twitter.com/p0laryse" rel="me" />
  
  
  <link href="https://infosec.exchange/@polaryse" rel="me" />
  
  
  <link href="https://github.com/polaryse" rel="me" />
  
  
  
  






  
  
  
  


  
  
  
  
  
</head><body
  class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32">
  <div id="the-top" class="absolute flex self-center">
    <a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
      href="#main-content"><span
        class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a>
  </div>
  
  
  <div style="padding-left:0;padding-right:0"
    class="flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3">
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            <a href="/" class="text-base font-medium text-gray-500 hover:text-gray-900">Malware Analysis: Or How I Learned To Love Frustration</a>
            
            
        </nav>
        <div class="hidden md:flex items-center space-x-5 md:ml-12">

            
            
            <a href="/posts/"  class="text-base font-medium text-gray-500 hover:text-gray-900" title="Posts">
                


                
                Blog
            </a>
            
            <a href=""  class="text-base font-medium text-gray-500 hover:text-gray-900" title="">
                


                
                Training Courses
            </a>
            
            <a href="/ctfs/"  class="text-base font-medium text-gray-500 hover:text-gray-900" title="CTFs">
                


                
                CTF Challenges
            </a>
            
            <a href="https://github.com/polaryse"  target="_blank" class="text-base font-medium text-gray-500 hover:text-gray-900" title="">
                


                
                Github
            </a>
            
            <a href="https://infosec.exchange/@polaryse"  target="_blank" class="text-base font-medium text-gray-500 hover:text-gray-900" title="">
                


                
                Mastodon
            </a>
            
            

            


            
            <button id="search-button" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            
            <div
                class="ltr:mr-14 rtl:ml-14 cursor-pointer text-sm text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400">
                <button id="appearance-switcher" type="button">
                    <div class="flex items-center justify-center h-12 dark:hidden">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                    </div>
                    <div class="items-center justify-center hidden h-12 dark:flex">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                    </div>
                </button>
            </div>
            

        </div>
        <div class="flex md:hidden items-center space-x-5 md:ml-12">

            <span></span>

            


            
            <button id="search-button-mobile" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            <button id="appearance-switcher-mobile" type="button" style="margin-right:5px">
                <div class="flex items-center justify-center h-12 dark:hidden">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                </div>
                <div class="items-center justify-center hidden h-12 dark:flex">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                </div>
            </button>
            

        </div>
    </div>
    <div class="-my-2 -mr-2 md:hidden">

        <label id="menu-button" for="menu-controller" class="block">
            <input type="checkbox" id="menu-controller" class="hidden" />
            <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
                

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


            </div>
            <div id="menu-wrapper" style="padding-top:25px;"
                class="fixed inset-0 z-30 invisible w-screen h-screen m-auto overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50">
                <ul
                    class="flex movedown flex-col w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl sm:px-14 md:px-24 lg:px-32 sm:py-10 sm:pt-10">
                    <li class="mb-1">
                        <span class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>

</span>
                    </li>

                    
                    
                    <li class="mb-1">
                        <a  class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                            href="/posts/" title="Posts">
                            <span class="inline-block align-text-bottom">

</span>
                            
                            Blog
                        </a>
                    </li>
                    
                    <li class="mb-1">
                        <a  class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                            href="" title="">
                            <span class="inline-block align-text-bottom">

</span>
                            
                            Training Courses
                        </a>
                    </li>
                    
                    <li class="mb-1">
                        <a  class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                            href="/ctfs/" title="CTFs">
                            <span class="inline-block align-text-bottom">

</span>
                            
                            CTF Challenges
                        </a>
                    </li>
                    
                    <li class="mb-1">
                        <a  target="_blank" class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                            href="https://github.com/polaryse" title="">
                            <span class="inline-block align-text-bottom">

</span>
                            
                            Github
                        </a>
                    </li>
                    
                    <li class="mb-1">
                        <a  target="_blank" class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                            href="https://infosec.exchange/@polaryse" title="">
                            <span class="inline-block align-text-bottom">

</span>
                            
                            Mastodon
                        </a>
                    </li>
                    
                    

                </ul>
            </div>
        </label>
    </div>
</div>
  
  <div class="relative flex flex-col grow">
    <main id="main-content" class="grow">
      


<article>
  
  
  
  
        <div class="w-full h-36 md:h-56 lg:h-72 single_hero_basic nozoom" style="background-image:url(/ctfs/simple-encryptor/featured_hubc053c01a9e9aafb463b27c46503858f_192227_1200x0_resize_q75_box.jpeg);"></div>
    
  <header id="single_header" class="mt-5 max-w-prose">
    
    <ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden">
  
  
    
  
    
  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/"
      >Malware Analysis: Or How I Learned To Love Frustration</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline ">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/ctfs/"
      >CTFs</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/ctfs/simple-encryptor/"
      >HTB Challenge: Simple Encryptor Part 1</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

</ol>


    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      HTB Challenge: Simple Encryptor Part 1
    </h1>
    <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      






































<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2023-03-18 00:00:00 &#43;0000 UTC">March 18, 2023</time><span class="px-2 text-primary-500">&middot;</span><span>2990 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">15 mins</span><span class="px-2 text-primary-500">&middot;</span>


  
    
  
  

<span class="mb-[2px]">
  <a
    href="#/CTFs/Simple%20Encryptor/index.md"
    class="text-lg hover:text-primary-500"
    rel="noopener noreferrer"
    target="_blank"
    title="Edit content"
    ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M490.3 40.4C512.2 62.27 512.2 97.73 490.3 119.6L460.3 149.7L362.3 51.72L392.4 21.66C414.3-.2135 449.7-.2135 471.6 21.66L490.3 40.4zM172.4 241.7L339.7 74.34L437.7 172.3L270.3 339.6C264.2 345.8 256.7 350.4 248.4 353.2L159.6 382.8C150.1 385.6 141.5 383.4 135 376.1C128.6 370.5 126.4 361 129.2 352.4L158.8 263.6C161.6 255.3 166.2 247.8 172.4 241.7V241.7zM192 63.1C209.7 63.1 224 78.33 224 95.1C224 113.7 209.7 127.1 192 127.1H96C78.33 127.1 64 142.3 64 159.1V416C64 433.7 78.33 448 96 448H352C369.7 448 384 433.7 384 416V319.1C384 302.3 398.3 287.1 416 287.1C433.7 287.1 448 302.3 448 319.1V416C448 469 405 512 352 512H96C42.98 512 0 469 0 416V159.1C0 106.1 42.98 63.1 96 63.1H192z"/></svg>

  </span>

</span></a
  >
</span>
  

  
  
</div>







    </div>
  </header>
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
     
    <div class="order-first sm:max-w-prose lg:ml-auto px-0 lg:order-last lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8">
      <div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky  lg:top-10 ">
        <details open class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden"
  >
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"
  >
    <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a>
      <ul>
        <li><a href="#analysis-environment">Analysis Environment</a></li>
        <li><a href="#what-is-ghidra">What is Ghidra?</a></li>
      </ul>
    </li>
    <li><a href="#the-challenge">The Challenge</a></li>
    <li><a href="#step-1-action-plan">Step 1: Action Plan</a></li>
    <li><a href="#step-2-ghidra-project--function-analysis">Step 2: Ghidra Project &amp; Function Analysis</a>
      <ul>
        <li><a href="#analysis-options">Analysis Options</a></li>
        <li><a href="#analysing-functions">Analysing Functions</a></li>
      </ul>
    </li>
    <li><a href="#step-3-analysing-main">Step 3: Analysing Main</a></li>
    <li><a href="#conclusion">Conclusion</a>
      <ul>
        <li><a href="#where-to-now">Where to now?</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>
<details class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden"
  >
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"
  >
    <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a>
      <ul>
        <li><a href="#analysis-environment">Analysis Environment</a></li>
        <li><a href="#what-is-ghidra">What is Ghidra?</a></li>
      </ul>
    </li>
    <li><a href="#the-challenge">The Challenge</a></li>
    <li><a href="#step-1-action-plan">Step 1: Action Plan</a></li>
    <li><a href="#step-2-ghidra-project--function-analysis">Step 2: Ghidra Project &amp; Function Analysis</a>
      <ul>
        <li><a href="#analysis-options">Analysis Options</a></li>
        <li><a href="#analysing-functions">Analysing Functions</a></li>
      </ul>
    </li>
    <li><a href="#step-3-analysing-main">Step 3: Analysing Main</a></li>
    <li><a href="#conclusion">Conclusion</a>
      <ul>
        <li><a href="#where-to-now">Where to now?</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>

      </div>
      </div>
      
      <div class="min-w-0 min-h-0 max-w-prose">
        
        <div id="introduction" class="anchor">Introduction></div>
<h2 class="relative group">Introduction 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#introduction" aria-label="Anchor">#</a></span>        
    
</h2><p>This adventure into the wonderful world of reverse engineering is brought to you by the great challenges available on <a href="https://www.hackthebox.com/"   target="_blank">
    Hack the Box</a>. I picked one of the easier challenges available on their website to test my slowly growing knowledge and understanding of how to use tools such as <a href="https://ghidra-sre.org/"   target="_blank">
    Ghidra</a>, <a href="https://hex-rays.com/ida-pro/"   target="_blank">
    IDA</a> and <a href="https://binary.ninja/"   target="_blank">
    Binary Ninja</a>. This particular sample was analysed statically using Ghidra. I&rsquo;ve included a little spiel below about the program, just in case anyone was interested. Otherwise feel free to skip and roll right on through to the analysis portion of this article!</p>
<div id="analysis-environment" class="anchor">Analysis Environment></div>
<h3 class="relative group">Analysis Environment 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#analysis-environment" aria-label="Anchor">#</a></span>        
    
</h3><p>I will be using an M1 Apple Silicon MacBook to perform analysis of this binary. I have built out a malware analysis VM environment on my machine which houses an assortment of macOS, Nix and Windows operating systems to perform both dynamic and static analysis safely (but more on this in a separate post!).</p>
<div id="what-is-ghidra" class="anchor">What is Ghidra?></div>
<h3 class="relative group">What is Ghidra? 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#what-is-ghidra" aria-label="Anchor">#</a></span>        
    
</h3><p>



  
  
    
  
  
    <figure>
      <img
        class="my-0 rounded-md"
        srcset="
          /ctfs/simple-encryptor/ghidra-logo-dark_hu08af4c8aa29da82cf2cac1c5813539fc_110729_330x0_resize_q75_box.jpg 330w,
          /ctfs/simple-encryptor/ghidra-logo-dark_hu08af4c8aa29da82cf2cac1c5813539fc_110729_660x0_resize_q75_box.jpg 660w,
          /ctfs/simple-encryptor/ghidra-logo-dark_hu08af4c8aa29da82cf2cac1c5813539fc_110729_1024x0_resize_q75_box.jpg 1024w,
          /ctfs/simple-encryptor/ghidra-logo-dark_hu08af4c8aa29da82cf2cac1c5813539fc_110729_1320x0_resize_q75_box.jpg 2x"
        src="/ctfs/simple-encryptor/ghidra-logo-dark_hu08af4c8aa29da82cf2cac1c5813539fc_110729_660x0_resize_q75_box.jpg"
        alt="Image alt"
      />
      
    </figure>
  

</p>
<p>Ghidra is a wonderful open-source disassembler that was developed by NSA&rsquo;s Research Directorate to support their Cybersecurity mission. It&rsquo;s a incredible tool with a lot of cool and honestly life-changing functions that displays assembly code in an easy-to-read format.</p>
<p>This particular tool is one of the perfect starting points for people new to the field because the cost of entry is <strong>nothing</strong> (unlike Binary Ninja and IDA Pro). That&rsquo;s right, you can use it for free! I would also recommend getting a copy of <a href="https://www.amazon.com/Ghidra-Book-Definitive-Guide-ebook/dp/B0852N9Y4Q"   target="_blank">
    Ghidra: The Definitive Guide</a> written by the impressive Chris Eagle (that&rsquo;s right, the same chap that wrote the Definitive Guide to IDA Pro!). It is a very comprehensive introduction (and really deep dive) into all the functionality offered by the platform—starting off with a wonderful introduction section that teaches you how to reverse engineer using the tool.</p>
<p>Ghidra is supplied across Linux, macOS, and Windows Operating Systems.</p>
<div id="the-challenge" class="anchor">The Challenge></div>
<h2 class="relative group">The Challenge 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#the-challenge" aria-label="Anchor">#</a></span>        
    
</h2><p>The zip archive of this challenge can be found via the hack the box website. I have provided the hashes of the executable below for reference.</p>
<table>
<thead>
<tr>
<th>Hash Value</th>
<th>Filename: encrypt</th>
</tr>
</thead>
<tbody>
<tr>
<td>SHA 256</td>
<td>035335fc74d59ff91f295c0ab0b9fbb0ff99060e508f7035004ab53604bee293</td>
</tr>
<tr>
<td>SHA 1</td>
<td>fa61d18fdd736213b11f7a51f9923f2bc7cde9e9</td>
</tr>
<tr>
<td>MD5</td>
<td>00ed50d5e50ab99e6a0c4911043b5dd3</td>
</tr>
</tbody>
</table>
<p>Download: <a href="https://www.hackthebox.com/"   target="_blank">
    Hack The Box</a></p>
<p>Unzipping the archive revealed two key artefacts: <code>encrypt</code> and <code>file.enc</code>. The initial theory was that the executable pushed out an encoded file into the directory it was run into. Let&rsquo;s get stuck into it and start understanding this!</p>
<div id="step-1-action-plan" class="anchor">Step 1: Action Plan></div>
<h2 class="relative group">Step 1: Action Plan 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#step-1-action-plan" aria-label="Anchor">#</a></span>        
    
</h2><p>Whenever I analyse a sample, the first step I generally take is to assess what information I have been provided with and come up with an “action plan” to guide my analysis. As someone who is easily pulled into rabbit holes, this approach often helps me stay on track when performing analysis.</p>
<p>For this sample, I came up with the following plan:</p>
<ol>
<li>What information/clues has the ZIP archive provided me with that could assist in understanding the function of this binary?
<ul>
<li>We have the executable titled <code>encrypt</code> and a file titled <code>flag.enc</code> (let&rsquo;s remember this name)</li>
</ul>
</li>
<li>Figure out the format of the executable—what platform does it normally run on? What VMs should I use to mitigate any risk in executing this?
<ul>
<li>Running <code>file</code> at the command line: <code>ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter</code>. Let&rsquo;s run static analysis on macOS or *nix then.</li>
</ul>
</li>
<li>What am I trying to achieve in analysing this sample?
<ul>
<li>Understand the encryption algorithm through static analysis</li>
<li>If any additional questions, run dynamically inside a VM</li>
<li>Write a decrypter for this sample to reveal the text (i.e. our flag)</li>
</ul>
</li>
</ol>
<p>With these broad questions in mind, let&rsquo;s get started.</p>
<div id="step-2-ghidra-project--function-analysis" class="anchor">Step 2: Ghidra Project &amp; Function Analysis></div>
<h2 class="relative group">Step 2: Ghidra Project &amp; Function Analysis 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#step-2-ghidra-project--function-analysis" aria-label="Anchor">#</a></span>        
    
</h2><p>We need a logical starting point for our analysis. Depending on your learning style, there will be multiple ways to approach this as your eyeballs are overwhelmed by the delightful spluttering of assembly and decompiled text of a new, unfamiliar binary. However, I would always recommend you follow through the default, auto analysis process provided by Ghidra until you are familiar enough with the program to make changes.</p>
<p>Open up Ghidra and start a new project. Ghidra should automatically assess that the binary is <code>x86:LE:64:default:gcc</code> which immediately gives us some additional clues as to what we are dealing with (if you didn&rsquo;t do any command line sleuthing beforehand).</p>
<p>Once your project is set up, double-click your imported file (in this case <code>encrypt</code>) and begin auto-analysis.</p>
<p>



  
  
    
  
  
    <figure>
      <img
        class="my-0 rounded-md"
        srcset="
          /ctfs/simple-encryptor/ghidra_project_overview_hub7fe1d56d1872d493eb3ecbeca260333_485574_330x0_resize_box_3.png 330w,
          /ctfs/simple-encryptor/ghidra_project_overview_hub7fe1d56d1872d493eb3ecbeca260333_485574_660x0_resize_box_3.png 660w,
          /ctfs/simple-encryptor/ghidra_project_overview_hub7fe1d56d1872d493eb3ecbeca260333_485574_1024x0_resize_box_3.png 1024w,
          /ctfs/simple-encryptor/ghidra_project_overview_hub7fe1d56d1872d493eb3ecbeca260333_485574_1320x0_resize_box_3.png 2x"
        src="/ctfs/simple-encryptor/ghidra_project_overview_hub7fe1d56d1872d493eb3ecbeca260333_485574_660x0_resize_box_3.png"
        alt="Image alt"
      />
      
    </figure>
  


<em>Figure 1: Auto-Analysis Prompt in Ghidra</em></p>
<div id="analysis-options" class="anchor">Analysis Options></div>
<h3 class="relative group">Analysis Options 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#analysis-options" aria-label="Anchor">#</a></span>        
    
</h3><p>By default, Ghidra does switch the majority of auto-analysis options on. Through discussions with a friend, there are some additional checks that should be performed prior to just hitting <code>Analyze</code>. Let&rsquo;s double-check that <code>ASCII Strings</code> &ldquo;minimum string length&rdquo; is set to <code>LEN_4</code> and (only because this program is small), let&rsquo;s turn on <code>Decompiler Parameter ID</code> for good measure.</p>
<p>



  
  
    
  
  
    <figure>
      <img
        class="my-0 rounded-md"
        srcset="
          /ctfs/simple-encryptor/ghidra_auto_analysis_hu145a582fbe2f510f45d4398550500ae6_259148_330x0_resize_box_3.png 330w,
          /ctfs/simple-encryptor/ghidra_auto_analysis_hu145a582fbe2f510f45d4398550500ae6_259148_660x0_resize_box_3.png 660w,
          /ctfs/simple-encryptor/ghidra_auto_analysis_hu145a582fbe2f510f45d4398550500ae6_259148_1024x0_resize_box_3.png 1024w,
          /ctfs/simple-encryptor/ghidra_auto_analysis_hu145a582fbe2f510f45d4398550500ae6_259148_1320x0_resize_box_3.png 2x"
        src="/ctfs/simple-encryptor/ghidra_auto_analysis_hu145a582fbe2f510f45d4398550500ae6_259148_660x0_resize_box_3.png"
        alt="Image alt"
      />
      
    </figure>
  


<em>Figure 2: Auto Analysis Options in Ghidra</em></p>
<p>Now hit apply and analyze.</p>
<div id="analysing-functions" class="anchor">Analysing Functions></div>
<h3 class="relative group">Analysing Functions 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#analysing-functions" aria-label="Anchor">#</a></span>        
    
</h3><p>Now we are ready to look at this program. Ghidra will provide a breakdown of all the functions present in the opened binary. In this case, being quite a small and simple program, there are not too many functions present. Of these, <code>main</code> seems like a very logical place to start analysis.</p>
<p>Moving to the main function, Ghidra provides two views; the Assembly code, and decompiled C.</p>
<p>We will start our analysis looking at the Decompiled C code for ease of readability and then compare this with the assembly output.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>undefined8 <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">void</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> iVar1;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">time_t</span> tVar2;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">long</span> in_FS_OFFSET;
</span></span><span style="display:flex;"><span>  uint local_40;
</span></span><span style="display:flex;"><span>  uint local_3c;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">long</span> local_38;
</span></span><span style="display:flex;"><span>  FILE <span style="color:#f92672">*</span>local_30;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">size_t</span> local_28;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>local_20;
</span></span><span style="display:flex;"><span>  FILE <span style="color:#f92672">*</span>local_18;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">long</span> local_10;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  local_10 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(<span style="color:#66d9ef">long</span> <span style="color:#f92672">*</span>)(in_FS_OFFSET <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x28</span>);
</span></span><span style="display:flex;"><span>  local_30 <span style="color:#f92672">=</span> <span style="color:#a6e22e">fopen</span>(<span style="color:#e6db74">&#34;flag&#34;</span>,<span style="color:#e6db74">&#34;rb&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fseek</span>(local_30,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">2</span>);
</span></span><span style="display:flex;"><span>  local_28 <span style="color:#f92672">=</span> <span style="color:#a6e22e">ftell</span>(local_30);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fseek</span>(local_30,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>  local_20 <span style="color:#f92672">=</span> <span style="color:#a6e22e">malloc</span>(local_28);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fread</span>(local_20,local_28,<span style="color:#ae81ff">1</span>,local_30);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fclose</span>(local_30);
</span></span><span style="display:flex;"><span>  tVar2 <span style="color:#f92672">=</span> <span style="color:#a6e22e">time</span>((<span style="color:#66d9ef">time_t</span> <span style="color:#f92672">*</span>)<span style="color:#ae81ff">0x0</span>);
</span></span><span style="display:flex;"><span>  local_40 <span style="color:#f92672">=</span> (uint)tVar2;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">srand</span>(local_40);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (local_38 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; local_38 <span style="color:#f92672">&lt;</span> (<span style="color:#66d9ef">long</span>)local_28; local_38 <span style="color:#f92672">=</span> local_38 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    iVar1 <span style="color:#f92672">=</span> <span style="color:#a6e22e">rand</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)local_20 <span style="color:#f92672">+</span> local_38) <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)local_20 <span style="color:#f92672">+</span> local_38) <span style="color:#f92672">^</span> (byte)iVar1;
</span></span><span style="display:flex;"><span>    local_3c <span style="color:#f92672">=</span> <span style="color:#a6e22e">rand</span>();
</span></span><span style="display:flex;"><span>    local_3c <span style="color:#f92672">=</span> local_3c <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">7</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)local_20 <span style="color:#f92672">+</span> local_38) <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)local_20 <span style="color:#f92672">+</span> local_38) <span style="color:#f92672">&lt;&lt;</span> (sbyte)local_3c <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)local_20 <span style="color:#f92672">+</span> local_38) <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">8</span> <span style="color:#f92672">-</span> (sbyte)local_3c;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  local_18 <span style="color:#f92672">=</span> <span style="color:#a6e22e">fopen</span>(<span style="color:#e6db74">&#34;flag.enc&#34;</span>,<span style="color:#e6db74">&#34;wb&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fwrite</span>(<span style="color:#f92672">&amp;</span>local_40,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">4</span>,local_18);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fwrite</span>(local_20,<span style="color:#ae81ff">1</span>,local_28,local_18);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fclose</span>(local_18);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (local_10 <span style="color:#f92672">!=</span> <span style="color:#f92672">*</span>(<span style="color:#66d9ef">long</span> <span style="color:#f92672">*</span>)(in_FS_OFFSET <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x28</span>)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* WARNING: Subroutine does not return */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">__stack_chk_fail</span>();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><em>Figure 3: The Main Function</em></p>
<p>At first glance, this code seems quite overwhelming. There are a lot of local variables that are doing… <em>things?</em> Resulting in another <em>thing</em>. Perhaps what is most interesting here though is the presence of a very particular file <code>flag.enc</code>, surrounded by some even more interesting calls. A quick squiz of the accompanying assembly code reveals the presence of an XOR, which could have something to do with the encryption function of this binary. Well worth a look.</p>
<div id="step-3-analysing-main" class="anchor">Step 3: Analysing Main></div>
<h2 class="relative group">Step 3: Analysing Main 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#step-3-analysing-main" aria-label="Anchor">#</a></span>        
    
</h2><p>Having identified main as a function of interest, this section of our analysis will focus on systematically working through the decompiled code to see whether we can get a good understanding of how the encryption process is being performed by this program.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>  local_10 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(<span style="color:#66d9ef">long</span> <span style="color:#f92672">*</span>)(in_FS_OFFSET <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x28</span>);
</span></span><span style="display:flex;"><span>  local_30 <span style="color:#f92672">=</span> <span style="color:#a6e22e">fopen</span>(<span style="color:#e6db74">&#34;flag&#34;</span>,<span style="color:#e6db74">&#34;rb&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fseek</span>(local_30,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">2</span>);
</span></span><span style="display:flex;"><span>  local_28 <span style="color:#f92672">=</span> <span style="color:#a6e22e">ftell</span>(local_30);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fseek</span>(local_30,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>  local_20 <span style="color:#f92672">=</span> <span style="color:#a6e22e">malloc</span>(local_28);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fread</span>(local_20,local_28,<span style="color:#ae81ff">1</span>,local_30);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fclose</span>(local_30);
</span></span></code></pre></div><p><em>Figure 4: Before the Encryption, Start of Main Function</em></p>
<p>This segment of code looks to open a file called <code>flag</code> in read mode, perform some data reads, assign to memory and then close off the file. However, the default language used by Ghidra doesn&rsquo;t really clearly tell us that story. Let&rsquo;s clean it up so it&rsquo;s more readable. To do this in Ghidra, simply click on the variable you want to rename and then <code>L</code> on your keyboard. You&rsquo;ll be presented with a prompt where you can input a new name that makes more sense to you in your analysis!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>  <span style="color:#75715e">/* ignore first line for the moment, likely a stack canary */</span>
</span></span><span style="display:flex;"><span>  stackCanary <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(<span style="color:#66d9ef">long</span> <span style="color:#f92672">*</span>)(in_FS_OFFSET <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x28</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* open flag file in read mode */</span>
</span></span><span style="display:flex;"><span>  originalFile <span style="color:#f92672">=</span> <span style="color:#a6e22e">fopen</span>(<span style="color:#e6db74">&#34;flag&#34;</span>,<span style="color:#e6db74">&#34;rb&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* right click and set equate in ghidra to automatically tell you what seek values are */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* i used this to designate 2 as SEEK_END */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* check man page for fseek to determine the meaning of the arguments */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fseek</span>(originalFile,<span style="color:#ae81ff">0</span>,SEEK_END);
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* go to the end of the file */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* ftell called to determine the size of the file*/</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* what byte position is it in? */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* store file size in variable fileSize */</span>
</span></span><span style="display:flex;"><span>  fileSize <span style="color:#f92672">=</span> <span style="color:#a6e22e">ftell</span>(originalFile);
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* return to the beginning of the file again */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fseek</span>(originalFile,<span style="color:#ae81ff">0</span>,SEEK_SET);
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* allocate memory to hold value of fileSize and assign to variable fileSizeInMem*/</span>
</span></span><span style="display:flex;"><span>  fileSizeInMem <span style="color:#f92672">=</span> <span style="color:#a6e22e">malloc</span>(fileSize);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fread</span>(fileSizeInMem,fileSize,<span style="color:#ae81ff">1</span>,originalFile);
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* close the flag file */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fclose</span>(originalFile);
</span></span></code></pre></div><p><em>Figure 5: Translating the Variables in the Main Function using Ghidra</em></p>
<p>Figure 5 shows the results of walking through the code, line by line, to determine the functions of each variable of the code. We are left with a better understanding of what data is considered important and where/how it is being stored/recorded by the binary. In addition to this, we comment the code for readability&rsquo;s sake if/when we return to our analysis in the future/to assist understanding in the community.</p>
<p>We continue through the rest of the code in main until all of the variables make a little more sense to us.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>undefined8 <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">void</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> randomNumberGen;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">time_t</span> setTime;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">long</span> in_FS_OFFSET;
</span></span><span style="display:flex;"><span>  uint castTime;
</span></span><span style="display:flex;"><span>  uint ranNumGen_2;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">long</span> byteIncrement;
</span></span><span style="display:flex;"><span>  FILE <span style="color:#f92672">*</span>originalFile;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">size_t</span> fileSize;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>allocateMem;
</span></span><span style="display:flex;"><span>  FILE <span style="color:#f92672">*</span>encodedFile;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">long</span> stackCanary;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* ignore first line for the moment, likely a stack canary */</span>
</span></span><span style="display:flex;"><span>  stackCanary <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(<span style="color:#66d9ef">long</span> <span style="color:#f92672">*</span>)(in_FS_OFFSET <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x28</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* open flag file in read mode */</span>
</span></span><span style="display:flex;"><span>  originalFile <span style="color:#f92672">=</span> <span style="color:#a6e22e">fopen</span>(<span style="color:#e6db74">&#34;flag&#34;</span>,<span style="color:#e6db74">&#34;rb&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* right click and set equate in ghidra to automatically tell you what seek values are */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* i used this to designate 2 as SEEK_END */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* check man page for fseek to determine the meaning of the arguments */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fseek</span>(originalFile,<span style="color:#ae81ff">0</span>,SEEK_END);
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* go to the end of the file */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* ftell called to determine the size of the file*/</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* what byte position is it in? */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* store file size in variable fileSize */</span>
</span></span><span style="display:flex;"><span>  fileSize <span style="color:#f92672">=</span> <span style="color:#a6e22e">ftell</span>(originalFile);
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* return to the beginning of the file again */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fseek</span>(originalFile,<span style="color:#ae81ff">0</span>,SEEK_SET);
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* allocate memory to hold value of fileSize and assign to variable   fileSizeInMem*/</span>
</span></span><span style="display:flex;"><span>  fileSizeInMem <span style="color:#f92672">=</span> <span style="color:#a6e22e">malloc</span>(fileSize);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fread</span>(fileSizeInMem,fileSize,<span style="color:#ae81ff">1</span>,originalFile);
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* close the flag file */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fclose</span>(originalFile);
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* get time and place into variable setTime */</span>
</span></span><span style="display:flex;"><span>  setTime <span style="color:#f92672">=</span> <span style="color:#a6e22e">time</span>((<span style="color:#66d9ef">time_t</span> <span style="color:#f92672">*</span>)<span style="color:#ae81ff">0x0</span>);
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* turn into an unsigned integer, meaning the value cannot be negative */</span>
</span></span><span style="display:flex;"><span>  castTime <span style="color:#f92672">=</span> (uint)setTime;
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* seed for the rand value based off of the variable setTime. If you have the same time, you have the seed for this random number generator */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">srand</span>(castTime);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/*now this is a weird section, a little hard to read*/</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (byteIncrement <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; byteIncrement <span style="color:#f92672">&lt;</span> (<span style="color:#66d9ef">long</span>)fileSize; byteIncrement <span style="color:#f92672">=</span> byteIncrement <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    randomNumberGen <span style="color:#f92672">=</span> <span style="color:#a6e22e">rand</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)fileSizeInMem <span style="color:#f92672">+</span> byteIncrement) <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)fileSizeInMem <span style="color:#f92672">+</span> byteIncrement) <span style="color:#f92672">^</span> (byte)randomNumberGen;
</span></span><span style="display:flex;"><span>    ranNumGen_2 <span style="color:#f92672">=</span> <span style="color:#a6e22e">rand</span>();
</span></span><span style="display:flex;"><span>    ranNumGen_2 <span style="color:#f92672">=</span> ranNumGen_2 <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">7</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)fileSizeInMem <span style="color:#f92672">+</span> byteIncrement) <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)fileSizeInMem <span style="color:#f92672">+</span> byteIncrement) <span style="color:#f92672">&lt;&lt;</span> (sbyte)ranNumGen_2 <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)fileSizeInMem <span style="color:#f92672">+</span> byteIncrement) <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">8</span> <span style="color:#f92672">-</span> (sbyte)ranNumGen_2;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* open the file called flag.enc with write privileges */</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* the b here is for system compatibility */</span>
</span></span><span style="display:flex;"><span>  encodedFile <span style="color:#f92672">=</span> <span style="color:#a6e22e">fopen</span>(<span style="color:#e6db74">&#34;flag.enc&#34;</span>,<span style="color:#e6db74">&#34;wb&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* write the first 4 bytes of castTime variable into the file */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fwrite</span>(<span style="color:#f92672">&amp;</span>castTime,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">4</span>,encodedFile);
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* write the contents of allocateMem into the file, for a total byte size of the fileSize variable */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fwrite</span>(fileSizeInMem,<span style="color:#ae81ff">1</span>,fileSize,encodedFile);
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* close the file*/</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fclose</span>(encodedFile);
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* this is the function end */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (stackCanary <span style="color:#f92672">!=</span> <span style="color:#f92672">*</span>(<span style="color:#66d9ef">long</span> <span style="color:#f92672">*</span>)(in_FS_OFFSET <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x28</span>)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* WARNING: Subroutine does not return */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">__stack_chk_fail</span>();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><em>Figure 6: Mostly Deobfuscated Main Function of Encrypt Binary</em></p>
<p>Let&rsquo;s summarise what information we can gather now we have translated the main function:</p>
<ul>
<li>a file called <code>flag</code> is read in by the program</li>
<li>the file size of <code>flag</code> is recorded</li>
<li>the current time is recorded and changed into an unsigned integer</li>
<li>the variable <code>castTime</code> is used as the seed for <code>srand</code> (and therefore we have the seed key)</li>
<li>Funky code containing some bitwise operations, bit shifting and number generation (we will dig into this deeper)</li>
<li>open the file <code>flag.enc</code> and place the contents of <code>castTime</code> into the file</li>
<li>Write the contents of <code>fileSizeInMem</code> into the file</li>
<li>Close the file</li>
<li>Exit program</li>
</ul>
<p>From the above, the only component of the code that Ghidra struggled to make sense the following segment:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#75715e">/*now this is a weird section, a little hard to read*/</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (byteIncrement <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; byteIncrement <span style="color:#f92672">&lt;</span> (<span style="color:#66d9ef">long</span>)fileSize; byteIncrement <span style="color:#f92672">=</span> byteIncrement <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    randomNumberGen <span style="color:#f92672">=</span> <span style="color:#a6e22e">rand</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)fileSizeInMem <span style="color:#f92672">+</span> byteIncrement) <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)fileSizeInMem <span style="color:#f92672">+</span> byteIncrement) <span style="color:#f92672">^</span> (byte)randomNumberGen;
</span></span><span style="display:flex;"><span>    ranNumGen_2 <span style="color:#f92672">=</span> <span style="color:#a6e22e">rand</span>();
</span></span><span style="display:flex;"><span>    ranNumGen_2 <span style="color:#f92672">=</span> ranNumGen_2 <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">7</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)fileSizeInMem <span style="color:#f92672">+</span> byteIncrement) <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)fileSizeInMem <span style="color:#f92672">+</span> byteIncrement) <span style="color:#f92672">&lt;&lt;</span> (sbyte)ranNumGen_2 <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)fileSizeInMem <span style="color:#f92672">+</span> byteIncrement) <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">8</span> <span style="color:#f92672">-</span> (sbyte)ranNumGen_2;
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p><em>Figure 7: Confusing Code Segment</em></p>
<p>But why is this significant? Well, judging by the presence of <code>rand()</code>, the right shift and left shift, and a bitwise, it is highly likely that this segment of code is our encryption component.</p>
<p>Here, we will need to reference the assembly instructions to see whether it provides any additional insights as to what series of operations are being performed here. We can achieve this through highlighting this segment of code in the decompiler, which will highlight the corresponding code in the assembly pane.</p>
<p>



  
  
    
  
  
    <figure>
      <img
        class="my-0 rounded-md"
        srcset="
          /ctfs/simple-encryptor/ghidra_encryption_for_loop_huce558d0890126b7c977e4efb23615d3d_769351_330x0_resize_box_3.png 330w,
          /ctfs/simple-encryptor/ghidra_encryption_for_loop_huce558d0890126b7c977e4efb23615d3d_769351_660x0_resize_box_3.png 660w,
          /ctfs/simple-encryptor/ghidra_encryption_for_loop_huce558d0890126b7c977e4efb23615d3d_769351_1024x0_resize_box_3.png 1024w,
          /ctfs/simple-encryptor/ghidra_encryption_for_loop_huce558d0890126b7c977e4efb23615d3d_769351_1320x0_resize_box_3.png 2x"
        src="/ctfs/simple-encryptor/ghidra_encryption_for_loop_huce558d0890126b7c977e4efb23615d3d_769351_660x0_resize_box_3.png"
        alt="Image Alt"
      />
      
    </figure>
  


<em>Figure 8: Equivalent Assembly Instructions</em></p>
<p>Looking at the assembly, there are two key instructions here (as highlighted) that provide clues as to what is going on. This is Ghidra&rsquo;s attempt to logically represent a <code>Rotate on Left</code>. This is definitely our encryption algorithm.</p>
<p>



  
  
    
  
  
    <figure>
      <img
        class="my-0 rounded-md"
        srcset="
          /ctfs/simple-encryptor/ROL_hue0afe866b15cd44b3e83aec7f004b4bb_3139_330x0_resize_box_3.png 330w,
          /ctfs/simple-encryptor/ROL_hue0afe866b15cd44b3e83aec7f004b4bb_3139_660x0_resize_box_3.png 660w,
          /ctfs/simple-encryptor/ROL_hue0afe866b15cd44b3e83aec7f004b4bb_3139_1024x0_resize_box_3.png 1024w,
          /ctfs/simple-encryptor/ROL_hue0afe866b15cd44b3e83aec7f004b4bb_3139_1320x0_resize_box_3.png 2x"
        src="/ctfs/simple-encryptor/ROL_hue0afe866b15cd44b3e83aec7f004b4bb_3139_660x0_resize_box_3.png"
        alt="Image alt"
      />
      
    </figure>
  


<em>Figure 9: Depiction of Rotate on Left</em></p>
<p>Let&rsquo;s amend our summary then:</p>
<ul>
<li>a file called <code>flag</code> is read in by the program</li>
<li>the file size of <code>flag</code> is recorded</li>
<li>the current time is recorded and changed into an unsigned integer</li>
<li>the variable <code>castTime</code> is used as the seed for <code>srand</code> (and therefore we have the seed key)</li>
<li>clear variables <code>randomNumGen</code> and <code>ranNumGen_2</code>, placing seed of <code>rand()</code> into both</li>
<li>perform bitwise operation on <code>ranNumGen_2</code> and <code>7</code></li>
<li>perform <code>ROL</code> on data</li>
<li>place the results of the encryption in variable <code>fileSizeInMem</code></li>
<li>open the file <code>flag.enc</code> and place the contents of <code>castTime</code> into the file</li>
<li>Write the contents of <code>fileSizeInMem</code> into the file</li>
<li>Close the file</li>
<li>Exit program</li>
</ul>
<p>As we explore writing a program to decrypt the data in <code>flag.enc</code>, our complete understanding of the above summary will likely change, as we understand the nuisances of the decryption process.</p>
<div id="conclusion" class="anchor">Conclusion></div>
<h2 class="relative group">Conclusion 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#conclusion" aria-label="Anchor">#</a></span>        
    
</h2><p>Post analysis of this file, we are left with a fairly good understanding of the encoding function performed by this binary. The entire main function has been changed into a much easier to read block of code, with one slightly funky section that was the result of Ghidra attempting to write out a ROL instruction somewhat logically (our major gotcha for this sample analysis). Figure 6 shows our the results of our hard work.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>undefined8 <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">void</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> randomNumberGen;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">time_t</span> setTime;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">long</span> in_FS_OFFSET;
</span></span><span style="display:flex;"><span>  uint castTime;
</span></span><span style="display:flex;"><span>  uint ranNumGen_2;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">long</span> byteIncrement;
</span></span><span style="display:flex;"><span>  FILE <span style="color:#f92672">*</span>originalFile;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">size_t</span> fileSize;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>allocateMem;
</span></span><span style="display:flex;"><span>  FILE <span style="color:#f92672">*</span>encodedFile;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">long</span> stackCanary;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* ignore first line for the moment, likely a stack canary */</span>
</span></span><span style="display:flex;"><span>  stackCanary <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(<span style="color:#66d9ef">long</span> <span style="color:#f92672">*</span>)(in_FS_OFFSET <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x28</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* open flag file in read mode */</span>
</span></span><span style="display:flex;"><span>  originalFile <span style="color:#f92672">=</span> <span style="color:#a6e22e">fopen</span>(<span style="color:#e6db74">&#34;flag&#34;</span>,<span style="color:#e6db74">&#34;rb&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* right click and set equate in ghidra to automatically tell you what seek values are */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* i used this to designate 2 as SEEK_END */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* check man page for fseek to determine the meaning of the arguments */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fseek</span>(originalFile,<span style="color:#ae81ff">0</span>,SEEK_END);
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* go to the end of the file */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* ftell called to determine the size of the file*/</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* what byte position is it in? */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* store file size in variable fileSize */</span>
</span></span><span style="display:flex;"><span>  fileSize <span style="color:#f92672">=</span> <span style="color:#a6e22e">ftell</span>(originalFile);
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* return to the beginning of the file again */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fseek</span>(originalFile,<span style="color:#ae81ff">0</span>,SEEK_SET);
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* allocate memory to hold value of fileSize and assign to variable   fileSizeInMem*/</span>
</span></span><span style="display:flex;"><span>  fileSizeInMem <span style="color:#f92672">=</span> <span style="color:#a6e22e">malloc</span>(fileSize);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fread</span>(fileSizeInMem,fileSize,<span style="color:#ae81ff">1</span>,originalFile);
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* close the flag file */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fclose</span>(originalFile);
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* get time and place into variable setTime */</span>
</span></span><span style="display:flex;"><span>  setTime <span style="color:#f92672">=</span> <span style="color:#a6e22e">time</span>((<span style="color:#66d9ef">time_t</span> <span style="color:#f92672">*</span>)<span style="color:#ae81ff">0x0</span>);
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* turn into an unsigned integer, meaning the value cannot be negative */</span>
</span></span><span style="display:flex;"><span>  castTime <span style="color:#f92672">=</span> (uint)setTime;
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* seed for the rand value based off of the variable setTime. If you have the same time, you have the seed for this random number generator */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">srand</span>(castTime);
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* for each byte in the file, until the length of the file is reached, complete the following*/</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (byteIncrement <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; byteIncrement <span style="color:#f92672">&lt;</span> (<span style="color:#66d9ef">long</span>)fileSize; byteIncrement <span style="color:#f92672">=</span> byteIncrement <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* place seed of rand into randomNumGen */</span>
</span></span><span style="display:flex;"><span>    randomNumberGen <span style="color:#f92672">=</span> <span style="color:#a6e22e">rand</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)fileSizeInMem <span style="color:#f92672">+</span> byteIncrement) <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)fileSizeInMem <span style="color:#f92672">+</span> byteIncrement) <span style="color:#f92672">^</span> (byte)randomNumberGen;
</span></span><span style="display:flex;"><span>    ranNumGen_2 <span style="color:#f92672">=</span> <span style="color:#a6e22e">rand</span>();
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* place seed of rand into ranNumGen_2 */</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* perform bitwise operation between ranNumGen_2 and digit 7 */</span>
</span></span><span style="display:flex;"><span>    ranNumGen_2 <span style="color:#f92672">=</span> ranNumGen_2 <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">7</span>;
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* perform ROL on data */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)fileSizeInMem <span style="color:#f92672">+</span> byteIncrement) <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)fileSizeInMem <span style="color:#f92672">+</span> byteIncrement) <span style="color:#f92672">&lt;&lt;</span> (sbyte)ranNumGen_2 <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">long</span>)fileSizeInMem <span style="color:#f92672">+</span> byteIncrement) <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">8</span> <span style="color:#f92672">-</span> (sbyte)ranNumGen_2;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* open the file called flag.enc with write privileges */</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* the b here is for system compatibility */</span>
</span></span><span style="display:flex;"><span>  encodedFile <span style="color:#f92672">=</span> <span style="color:#a6e22e">fopen</span>(<span style="color:#e6db74">&#34;flag.enc&#34;</span>,<span style="color:#e6db74">&#34;wb&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* write the first 4 bytes of castTime variable into the file */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fwrite</span>(<span style="color:#f92672">&amp;</span>castTime,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">4</span>,encodedFile);
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* write the contents of allocateMem into the file, for a total byte size of the fileSize variable */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fwrite</span>(fileSizeInMem,<span style="color:#ae81ff">1</span>,fileSize,encodedFile);
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* close the file*/</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fclose</span>(encodedFile);
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* this is the function end */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (stackCanary <span style="color:#f92672">!=</span> <span style="color:#f92672">*</span>(<span style="color:#66d9ef">long</span> <span style="color:#f92672">*</span>)(in_FS_OFFSET <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x28</span>)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* WARNING: Subroutine does not return */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">__stack_chk_fail</span>();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><em>Figure 10: Completely Deobfuscated Main Function of Encrypt Binary</em></p>
<div id="where-to-now" class="anchor">Where to now?></div>
<h3 class="relative group">Where to now? 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#where-to-now" aria-label="Anchor">#</a></span>        
    
</h3><p>For now, we take a well-earned break and do a little happy dance to celebrate completing the first component of this challenge—understanding the encryption algorithm used by the program to encode the flag.</p>
<p>The next part in this series will move onto writing a simple program to reverse the encoding performed on this text, hopefully revealing our flag in plain text and solving the final component of this challenge.</p>

        </br></br>
        
      </div>
      <script>

        var liked_article = false

        if (typeof auth !== 'undefined') {
          var oid = "views_CTFs\/Simple Encryptor\/index.md"
          var id = oid ? oid.replaceAll("/", "-") : oid

          var viewed = localStorage.getItem(id);

          if (!viewed) {
            auth.signInAnonymously()
              .then(() => {
                var docRef = db.collection('views').doc(id)
                localStorage.setItem(id, true);
                docRef.get().then((doc) => {
                  if (doc.exists) {
                    db.collection('views').doc(id).update({
                      views: firebase.firestore.FieldValue.increment(1)
                    });
                  } else {
                    db.collection('views').doc(id).set({ views: 1 })
                  }
                }).catch((error) => {
                  console.log("Error getting document:", error);
                });
              })
              .catch((error) => {
                var errorCode = error.code;
                var errorMessage = error.message;
                console.error(errorCode, errorMessage)
              });
          }

          var oid_likes = "likes_CTFs\/Simple Encryptor\/index.md"
          var id_likes = oid_likes ? oid_likes.replaceAll("/", "-") : oid_likes

          var liked = localStorage.getItem(id_likes);

          if (liked) {
            liked_article = true
            document.querySelectorAll("span[id='likes_button_heart']")[0].style.display = ""
            document.querySelectorAll("span[id='likes_button_emtpty_heart']")[0].style.display = "none"
            document.querySelectorAll("span[id='likes_button_text']")[0].innerText = ""
          }

        }

        function like_article(id_likes) {
          auth.signInAnonymously()
            .then(() => {
              var docRef = db.collection('likes').doc(id_likes)
              docRef.get().then((doc) => {
                liked_article = true
                localStorage.setItem(id_likes, true);
                document.querySelectorAll("span[id='likes_button_heart']")[0].style.display = ""
                document.querySelectorAll("span[id='likes_button_emtpty_heart']")[0].style.display = "none"
                document.querySelectorAll("span[id='likes_button_text']")[0].innerText = ""
                if (doc.exists) {
                  db.collection('likes').doc(id_likes).update({
                    likes: firebase.firestore.FieldValue.increment(1)
                  });
                } else {
                  db.collection('likes').doc(id_likes).set({ likes: 1 })
                }
              }).catch((error) => {
                console.log("Error getting document:", error);
              });
            })
            .catch((error) => {
              var errorCode = error.code;
              var errorMessage = error.message;
              console.error(errorCode, errorMessage)
            });
        }

        function remove_like_article(id_likes) {
          auth.signInAnonymously()
            .then(() => {
              var docRef = db.collection('likes').doc(id_likes)
              docRef.get().then((doc) => {
                liked_article = false
                localStorage.removeItem(id_likes);
                document.querySelectorAll("span[id='likes_button_heart']")[0].style.display = "none"
                document.querySelectorAll("span[id='likes_button_emtpty_heart']")[0].style.display = ""
                document.querySelectorAll("span[id='likes_button_text']")[0].innerText = "\xa0Like"
                if (doc.exists) {
                  db.collection('likes').doc(id_likes).update({
                    likes: firebase.firestore.FieldValue.increment(-1)
                  });
                } else {
                  db.collection('likes').doc(id_likes).set({ likes: 0 })
                }
              }).catch((error) => {
                console.log("Error getting document:", error);
              });
            })
            .catch((error) => {
              var errorCode = error.code;
              var errorMessage = error.message;
              console.error(errorCode, errorMessage)
            });
        }

        function process_article() {
          var oid_likes = "likes_CTFs\/Simple Encryptor\/index.md"
          var id_likes = oid_likes ? oid_likes.replaceAll("/", "-") : oid_likes
          if (!liked_article) {
            like_article(id_likes)
          } else {
            remove_like_article(id_likes)
          }
        }

      </script>
  </section>
  <footer class="pt-8 max-w-prose print:hidden">

    
  <div class="flex">
    
      
      
        
        <img
          class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4"
          width="96"
          height="96"
          alt="polaryse"
          src="/author_hu60a6ef9a1dfe976efadd873b0b5859d3_73965_192x192_fill_box_smart1_3.png"
        />
      
    
    <div class="place-self-center">
      
        <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
          Author
        </div>
        <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
          polaryse
        </div>
      
      
        <div class="text-sm text-neutral-700 dark:text-neutral-400">Just a beginner Malware Analyst documenting their exploration of the wonderful world of malware.</div>
      
      <div class="text-2xl sm:text-lg">
  <div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://twitter.com/p0laryse"
          target="_blank"
          aria-label="Twitter"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://infosec.exchange/@polaryse"
          target="_blank"
          aria-label="Mastodon"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://github.com/polaryse"
          target="_blank"
          aria-label="Github"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>

</span></a
        >
      
    
  </div>

</div>
    </div>
  </div>



    
    
    

    

    

    
  <section class="flex flex-row flex-wrap justify-center pt-4 text-xl">
    
      
        <a
          target="_blank"
          class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="mailto:?body=https://polaryse.github.io/ctfs/simple-encryptor/&amp;subject=HTB%20Challenge:%20Simple%20Encryptor%20Part%201"
          title="Send via email"
          aria-label="Send via email"
          >
          

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z"/></svg>

  </span>


        </a>
      
    
      
        <a
          target="_blank"
          class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://www.facebook.com/sharer/sharer.php?u=https://polaryse.github.io/ctfs/simple-encryptor/&amp;quote=HTB%20Challenge:%20Simple%20Encryptor%20Part%201"
          title="Share on Facebook"
          aria-label="Share on Facebook"
          >
          

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>

  </span>


        </a>
      
    
      
        <a
          target="_blank"
          class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://polaryse.github.io/ctfs/simple-encryptor/&amp;title=HTB%20Challenge:%20Simple%20Encryptor%20Part%201"
          title="Share on LinkedIn"
          aria-label="Share on LinkedIn"
          >
          

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>

  </span>


        </a>
      
    
      
        <a
          target="_blank"
          class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://pinterest.com/pin/create/bookmarklet/?url=https://polaryse.github.io/ctfs/simple-encryptor/&amp;description=HTB%20Challenge:%20Simple%20Encryptor%20Part%201"
          title="Pin on Pinterest"
          aria-label="Pin on Pinterest"
          >
          

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M496 256c0 137-111 248-248 248-25.6 0-50.2-3.9-73.4-11.1 10.1-16.5 25.2-43.5 30.8-65 3-11.6 15.4-59 15.4-59 8.1 15.4 31.7 28.5 56.8 28.5 74.8 0 128.7-68.8 128.7-154.3 0-81.9-66.9-143.2-152.9-143.2-107 0-163.9 71.8-163.9 150.1 0 36.4 19.4 81.7 50.3 96.1 4.7 2.2 7.2 1.2 8.3-3.3.8-3.4 5-20.3 6.9-28.1.6-2.5.3-4.7-1.7-7.1-10.1-12.5-18.3-35.3-18.3-56.6 0-54.7 41.4-107.6 112-107.6 60.9 0 103.6 41.5 103.6 100.9 0 67.1-33.9 113.6-78 113.6-24.3 0-42.6-20.1-36.7-44.8 7-29.5 20.5-61.3 20.5-82.6 0-19-10.2-34.9-31.4-34.9-24.9 0-44.9 25.7-44.9 60.2 0 22 7.4 36.8 7.4 36.8s-24.5 103.8-29 123.2c-5 21.4-3 51.6-.9 71.2C65.4 450.9 0 361.1 0 256 0 119 111 8 248 8s248 111 248 248z"/></svg>

  </span>


        </a>
      
    
      
        <a
          target="_blank"
          class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://reddit.com/submit/?url=https://polaryse.github.io/ctfs/simple-encryptor/&amp;resubmit=true&amp;title=HTB%20Challenge:%20Simple%20Encryptor%20Part%201"
          title="Submit to Reddit"
          aria-label="Submit to Reddit"
          >
          

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M201.5 305.5c-13.8 0-24.9-11.1-24.9-24.6 0-13.8 11.1-24.9 24.9-24.9 13.6 0 24.6 11.1 24.6 24.9 0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4 0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7 0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9 0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5 0 52.6 59.2 95.2 132 95.2 73.1 0 132.3-42.6 132.3-95.2 0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6 0-2.2-2.2-6.1-2.2-8.3 0-2.5 2.5-2.5 6.4 0 8.6 22.8 22.8 87.3 22.8 110.2 0 2.5-2.2 2.5-6.1 0-8.6-2.2-2.2-6.1-2.2-8.3 0zm7.7-75c-13.6 0-24.6 11.1-24.6 24.9 0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.1 24.9-24.6 0-13.8-11-24.9-24.9-24.9z"/></svg>

  </span>


        </a>
      
    
      
        <a
          target="_blank"
          class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://twitter.com/intent/tweet/?url=https://polaryse.github.io/ctfs/simple-encryptor/&amp;text=HTB%20Challenge:%20Simple%20Encryptor%20Part%201"
          title="Tweet on Twitter"
          aria-label="Tweet on Twitter"
          >
          

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>

  </span>


        </a>
      
    
  </section>


    
  


    
  </footer>
</article>

      
      <div class="pointer-events-none absolute top-[100vh] bottom-0 w-12 ltr:right-0 rtl:left-0">
        <a href="#the-top"
          class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
          aria-label="" title="">
          &uarr;
        </a>
      </div>
      
    </main><footer class="py-10 print:hidden">
  
  
    
    <nav class="pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400">
      <ul class="flex flex-col list-none sm:flex-row">
        
        <li class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=""
            title="">This website has been created for educational porpoises</a>
        </li>
        
      </ul>
    </nav>
    
  
  <div class="flex items-center justify-between">

    
    
    <p class="text-sm text-neutral-500 dark:text-neutral-400">
      &copy;
      2023
      polaryse
    </p>
    

    
    
    <p class="text-xs text-neutral-500 dark:text-neutral-400">
      
      
      Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://nunocoracao.github.io/blowfish/" target="_blank" rel="noopener noreferrer">Blowfish</a>
    </p>
    

  </div>
  <script>
    
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
    
  </script>
  
  
  <script type="text/javascript" src="/js/process.min.2166d3adac1679c00a75161830ab5725d3efc0e3d3f8c2453fb01d0907948436c25f0f8a7ad824322fa22f3f9c85fd4d0a1d5c856f53b862157da25a57dc3d52.js" integrity="sha512-IWbTrawWecAKdRYYMKtXJdPvwOPT&#43;MJFP7AdCQeUhDbCXw&#43;KetgkMi&#43;iLz&#43;chf1NCh1chW9TuGIVfaJaV9w9Ug=="></script>
  
  
</footer><div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url="https://polaryse.github.io/"
  style="z-index:500"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

  </div>
</body>

</html>